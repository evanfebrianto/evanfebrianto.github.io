<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Traffic Sign Classifier | Evan Febrianto</title> <meta name="author" content="Evan Febrianto"/> <meta name="description" content="TensorFlow, Python, Jupyter"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/avatar.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://evanfebrianto.github.io/projects/cv-traffic-classifier/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://evanfebrianto.github.io/"><span class="font-weight-bold">Evan</span> Febrianto</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/resume.pdf">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Traffic Sign Classifier</h1> <p class="post-description">TensorFlow, Python, Jupyter</p> <p class="post-github"> <a href="https://github.com/evanfebrianto/Traffic-Sign-Classifier-Project" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> <span-github-link> View on GitHub </span-github-link> </a> </p> </header> <article> <h3 id="goals">Goals</h3> <p>The goals / steps of this project are the following:</p> <ul> <li>Load the data set (see below for links to the project data set)</li> <li>Explore, summarize and visualize the data set</li> <li>Design, train and test a model architecture</li> <li>Use the model to make predictions on new images</li> <li>Analyze the softmax probabilities of the new images</li> <li>Summarize the results with a written report</li> </ul> <h3 id="data-set-summary--exploration">Data Set Summary &amp; Exploration</h3> <p>I used numpy and python to calculate summary statistics of the traffic signs dataset and seaborn to visualize:</p> <ul> <li>The size of training set is 34799</li> <li>The size of test set is 12630</li> <li>The shape of a traffic sign image is (32, 32, 3)</li> <li>The number of unique classes/labels in the data set is 43</li> </ul> <p>Here is an exploratory visualization of the data set. It is a bar chart showing how the data distributed over 43 classes.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0" align="center"> <figure> <picture> <img src="/assets/img/traffic_sign/dataset-distribution.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Dataset Distribution" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Dataset Distribution </div> <p>Below is the example of how the dataset looks like.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0" align="center"> <figure> <picture> <img src="/assets/img/traffic_sign/sample-data.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Sample Data" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Sample Dataset Visualization </div> <h3 id="design-and-test-a-model-architecture">Design and Test a Model Architecture</h3> <p>As a first step, I decided to normalize the image to improve the accuracy and it gives me a positive result. Because some of the data are limited compared to the others, I decided to generate additional data. This can improve make the model more robust because it has more data to learn.</p> <p>To add more data to the the data set, I applied some small distortion effect to the dataset.</p> <p>Here is an example of an original image and an augmented image:</p> <div class="row"> <div class="col-sm-6 mt-3 mt-md-0" align="center"> <figure> <picture> <img src="/assets/img/traffic_sign/undistorted.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Undistorted" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0" align="center"> <figure> <picture> <img src="/assets/img/traffic_sign/distorted.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Distorted" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Original image (left), Augmented Image (right) </div> <p>After I generated this augmented data, the dataset becomes much bigger.</p> <h4 id="model">Model</h4> <p>My final model consisted of the following layers:</p> <table class="table table-striped"> <thead class="thead-dark"> <tr> <th scope="col">Layer</th> <th scope="col">Description</th> </tr> </thead> <tbody> <tr> <td>Input</td> <td>32x32x3 RGB image</td> </tr> <tr> <td>Convolution 5x5</td> <td>1x1 stride, valid padding, outputs 28x28x32</td> </tr> <tr> <td>RELU</td> <td></td> </tr> <tr> <td>Max pooling</td> <td>2x2 stride, outputs 14x14x32</td> </tr> <tr> <td>Convolution 5x5</td> <td>1x1 stride, valid padding, outputs 10x10x32</td> </tr> <tr> <td>RELU</td> <td></td> </tr> <tr> <td>Max pooling</td> <td>2x2 stride, outputs 5x5x32</td> </tr> <tr> <td>Droprout</td> <td>2x2 stride, outputs 14x14x32</td> </tr> <tr> <td>Max pooling</td> <td>keep_prob = 0.5</td> </tr> <tr> <td>Fully connected</td> <td>Input 1600, outputs 120</td> </tr> <tr> <td>RELU</td> <td></td> </tr> <tr> <td>Max pooling</td> <td>2x2 stride, outputs 14x14x32</td> </tr> <tr> <td>RELU</td> <td></td> </tr> <tr> <td>Droprout</td> <td>keep_prob = 0.5</td> </tr> <tr> <td>Fully connected</td> <td>Input 120, outputs 84</td> </tr> <tr> <td>RELU</td> <td></td> </tr> <tr> <td>Droprout</td> <td>keep_prob = 0.5</td> </tr> <tr> <td>Fully connected</td> <td>Input 84, outputs 43</td> </tr> </tbody> </table> <p>To train the model, I used AdamOptimizer, a batch size of 128, 20 epochs, a learn rate of 0.001. Lastly, I used 0.5 of dropout rate for training to achieve highest validation accuracy.</p> <h4 id="result">Result</h4> <p>My final model results were:</p> <ul> <li>training set accuracy of 0.997</li> <li>validation set accuracy of 0.983</li> <li>test set accuracy of 0.972</li> </ul> <p>I started with original LeNet architecture as it has been provided from the previous lecture. I managed to achieve around 0.893 validation accuracy. However, it is not good enough. I added the depth and also more layer to extract more features. I know this may result in overfitting, that is why I put dropout operations between the fully connected layers. Surprisingly, the result was very good on the validation and test data.</p> <h3 id="test-a-model-on-new-images">Test a Model on New Images</h3> <p>Here are eight German traffic signs that I found on the web that are completely not inside the training sets:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0" align="center"> <figure> <picture> <img src="/assets/img/traffic_sign/test-images.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Test Images" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The difficulty from these images is that they have different size. I programmed to resize them to be 32x32 pixels so that it will fit to the model. On top of that, the third image is a bit darker compared to the others.</p> <p>Here are the results of the prediction:</p> <table class="table table-striped"> <thead class="thead-dark"> <tr> <th scope="col">Image</th> <th scope="col">Prediction</th> </tr> </thead> <tbody> <tr> <td>Speed limit (30km/h)</td> <td>Speed limit (30km/h)</td> </tr> <tr> <td>Right-of-way at the next intersection</td> <td>Right-of-way at the next intersection</td> </tr> <tr> <td>Priority road</td> <td>Priority road</td> </tr> <tr> <td>Vehicles over 3.5 metric tons prohibited</td> <td>Vehicles over 3.5 metric tons prohibited</td> </tr> <tr> <td>General caution</td> <td>General caution</td> </tr> <tr> <td>Turn right ahead</td> <td>Turn right ahead</td> </tr> <tr> <td>Keep right</td> <td>Keep right</td> </tr> </tbody> </table> <p>The model was able to correctly guess 8 of the 8 traffic signs, which gives an accuracy of 100%. This compares favorably to the accuracy on the test set of 97.2%</p> <p>Below is the probablity after I used softmax.</p> <p>The first image</p> <ul> <li>Speed limit (30km/h): 1.00000</li> <li>Speed limit (20km/h): 0.00000</li> <li>Speed limit (50km/h): 0.00000</li> <li>General caution: 0.00000</li> <li>Speed limit (80km/h): 0.00000</li> </ul> <p>The second image</p> <ul> <li>Right-of-way at the next intersection: 1.00000</li> <li>Beware of ice/snow: 0.00000</li> <li>Double curve: 0.00000</li> <li>Pedestrians: 0.00000</li> <li>End of no passing by vehicles over 3.5 metric tons: 0.00000</li> </ul> <p>The third image</p> <ul> <li>Priority road: 1.00000</li> <li>End of all speed and passing limits: 0.00000</li> <li>Yield: 0.00000</li> <li>Keep right: 0.00000</li> <li>End of no passing: 0.00000</li> </ul> <p>The fourth image</p> <ul> <li>Vehicles over 3.5 metric tons prohibited: 1.00000</li> <li>No passing: 0.00000</li> <li>Speed limit (100km/h): 0.00000</li> <li>End of no passing by vehicles over 3.5 metric tons: 0.00000</li> <li>Speed limit (60km/h): 0.00000</li> </ul> <p>The fifth image</p> <ul> <li>General caution: 1.00000</li> <li>Traffic signals: 0.00000</li> <li>Pedestrians: 0.00000</li> <li>Road narrows on the right: 0.00000</li> <li>Road work: 0.00000</li> </ul> <p>The sixth image</p> <ul> <li>Turn right ahead: 1.00000</li> <li>Ahead only: 0.00000</li> <li>Go straight or right: 0.00000</li> <li>Go straight or left: 0.00000</li> <li>Turn left ahead: 0.00000</li> </ul> <p>The seventh image</p> <ul> <li>Keep right: 1.00000</li> <li>Turn left ahead: 0.00000</li> <li>Roundabout mandatory: 0.00000</li> <li>Speed limit (50km/h): 0.00000</li> <li>Speed limit (20km/h): 0.00000</li> </ul> <p>The eighth image</p> <ul> <li>Keep right: 1.00000</li> <li>Turn left ahead: 0.00000</li> <li>Roundabout mandatory: 0.00000</li> <li>Speed limit (50km/h): 0.00000</li> <li>Speed limit (20km/h): 0.00000</li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2022 Evan Febrianto. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>